<p id="notice"><%= notice %></p>

<dl class='metadata-block'>
  <tr>
    <dt>Oid:</dt>
    <dd><%= @parent_object.oid %></dd>
  </tr>
  <tr>
    <dt>Set:</dt>
    <dd><%= @parent_object.admin_set&.label %></dd>
  </tr>
  <% if @parent_object.permission_set_id.present? %>
    <tr>
      <dt>Permission Set:</dt>
      <dd><%= PermissionSet.find(@parent_object.permission_set_id).label %></dd>
    </tr>
  <% end %>
  <tr>
    <dt>Call Number:</dt>
    <dd><%= @parent_object.call_number %></dd>
  </tr>
  <tr>
    <dt>Project ID:</dt>
    <dd><%= @parent_object&.project_identifier %></dd>
  </tr>
  <% if @parent_object&.redirect_to.present? %>
    <tr>
      <dt>Redirected To:</dt>
      <dd><%= @parent_object&.redirect_to %></dd>
    </tr>
  <% end %>
  <tr>
    <dt>Authoritative Metadata source:</dt>
    <dd><%= @parent_object.authoritative_metadata_source.display_name %></dd>
  </tr>
  <tr>
    <dt>Bib:</dt>
    <dd><%= @parent_object.bib %></dd>
  </tr>
  <tr>
    <dt>Holding:</dt>
    <dd><%= @parent_object.holding %></dd>
  </tr>
  <tr>
    <dt>Item:</dt>
    <dd><%= @parent_object.item %></dd>
  </tr>
  <tr>
    <dt>Container Grouping:</dt>
    <dd><%= @parent_object.container_grouping %></dd>
  </tr>
  <tr>
    <dt>Barcode:</dt>
    <dd><%= @parent_object.barcode %></dd>
  </tr>
  <tr>
    <dt>Aspace uri:</dt>
    <dd><%= @parent_object.aspace_uri %></dd>
  </tr>
  <tr>
    <dt>Child Count:</dt>
    <dd><%= @parent_object.child_object_ids.count %></dd>
  </tr>
  <tr>
    <div class="child-objects">
      <dt>Children:</dt>
      <dd class="child-list">
        <ol class="child-list-ol">
          <% @parent_object.child_objects.map do |child| %>
            <p><li><%= link_to( "#{child.label || 'no label'} / #{child.caption || 'no caption'} (#{child.width}, #{child.height})", "#{child_objects_path}/#{child.oid}") %></li></p>
          <% end %>
        </ol>
      </dd>
    </div>
  </tr>
  <tr>
    <dt>Visibility:</dt>
    <dd><%= @parent_object.visibility %></dd>
  </tr>
  <tr>
    <dt>Rights Statement:</dt>
    <dd><%= sanitize @parent_object.rights_statement, tags: %w(a), attributes: %w(href) %></dd>
  </tr>
  <tr>
    <% if @parent_object.representative_child %>
      <dt class="represent-thumb">Representative thumbnail:</dt>
      <dd><%= image_tag @parent_object.representative_child.thumbnail_url %></dd>
    <% end %>
    
    <dt></dt><dd><%= link_to("Select different representative thumbnail", select_thumbnail_parent_object_path) %></dd>
  </tr>
  <tr>
    <dt>Extent of Digitization:</dt>
    <dd><%= @parent_object.extent_of_digitization %></dd>
  </tr>
  <tr>
    <dt>Digitization Note:</dt>
    <dd><%= @parent_object.digitization_note %></dd>
  </tr>
  <tr>
    <dt>Digitization Funding Source:</dt>
    <dd><%= @parent_object.digitization_funding_source %></dd>
  </tr>
  <tr>
    <dt>Viewing Direction:</dt>
    <dd><%= @parent_object.viewing_direction %></dd>
  </tr>
  <tr>
    <dt>Display Layout / Viewing Hint:</dt>
    <dd><%= @parent_object.display_layout %></dd>
  </tr>
  <tr>
    <dt>Full Text Available:</dt>
    <dd><%= @parent_object.extent_of_full_text %></dd>
  </tr>
  <tr>
    <dt>Digital Object Source:</dt>
    <dd><%= @parent_object.digital_object_source %></dd>
  </tr>
  <% if @parent_object&.metadata_cloud_url.present? %>
    <tr>
      <dt>MetadataCloud url:</dt>
      <dd><%= link_to "#{@parent_object.metadata_cloud_url}", "#{@parent_object.metadata_cloud_url}" %></dd>
    </tr>
  <% end %>
  <tr>
    <dt>Preservica URI:</dt>
    <dd><%= @parent_object.preservica_uri %></dd>
  </tr>
  <tr>
    <dt>Preservica Representation Type:</dt>
    <dd><%= @parent_object.preservica_representation_type %></dd>
  </tr>
  <% if @parent_object.digital_object_source == 'Preservica' %>
    <tr>
      <dt>Update from Preservica:</dt>
      <dd><%= link_to 'Synchronize child objects', sync_from_preservica_parent_object_path(@parent_object), method: :post, class: 'btn button update-item-button'%></dd>
    </tr>
  <% end %>
  <tr>
    <dt>Last Aspace Update:</dt>
    <dd><%= @parent_object.last_aspace_update %></dd>
  </tr>
  <tr>
    <dt>Last Voyager Update:</dt>
    <dd><%= @parent_object.last_voyager_update %></dd>
  </tr>
  <tr>
    <dt>Last Preservica Update:</dt>
    <dd><%= @parent_object.last_preservica_update %></dd>
  </tr>
  <tr>
    <dt>Last Ladybird Update:</dt>
    <dd><%= @parent_object.last_ladybird_update %></dd>
  </tr>
  <tr>
    <dt><%= link_to('View version history', parent_object_versions_path(@parent_object, :checked => 'true')) %></dt>
    <dd></dd>
  </tr>
</dl>

<p class='show-header'>
  <strong>Authoritative JSON:</strong>
  <%= render 'authoritative_json', parent_object: @parent_object %>
</p>

<p class='show-header'>
  <strong>Solr Record:</strong>
  <%= render 'solr_document', parent_object: @parent_object %>
</p>

<% if can? :update, @parent_object %>
  <div class='update-item-container'>
    <div>
      <p class='update-item-label'>Update this Item</p>
      <p>Update metadata for this object from the authoritative metadata source.</p>
    </div>
    <div>
      <%= link_to 'Update this item', update_metadata_parent_object_path(@parent_object), method: :post, class: 'btn button update-item-button' %>
    </div>
  </div>
<% end %>
<% if can? :destroy, @parent_object %>
  <div class='delete-item-container'>
    <div>
      <p class='delete-item-label'>Delete this Item</p>
      <p>Permanently delete this item and its children.</p>
    </div>
    <div>
      <%= link_to 'Delete this item', parent_object_path(@parent_object), method: :delete, data: { confirm: 'Are you sure you want to delete this item and its children?' }, class: 'btn button delete-item-button' %>
    </div>
  </div>
<% end %>
<% if can? :edit, @parent_object %>
  <%= link_to 'Edit', edit_parent_object_path(@parent_object) %> |
<% end %>
<%= link_to 'Solr Document', solr_document_parent_object_path("#{@parent_object.oid}"), target: '_blank' %> |
<%= link_to 'Public View', @parent_object.dl_show_url, target: '_blank' %> |
<%= link_to 'Back', parent_objects_path %>
